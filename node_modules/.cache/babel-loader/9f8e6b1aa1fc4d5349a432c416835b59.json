{"ast":null,"code":"import _objectSpread from \"/home/roxiler/Desktop/formik_demo/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/home/roxiler/Desktop/formik_demo/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport decode from \"jwt-decode\";\n\nvar AuthHelperMethods = // Initializing important variables\nfunction AuthHelperMethods(domain) {\n  var _this = this;\n\n  _classCallCheck(this, AuthHelperMethods);\n\n  this.login = function (username, password) {\n    // Get a token from api server using the fetch api\n    return _this.fetch(\"/api/oauth/token\", {\n      method: \"POST\",\n      body: JSON.stringify({\n        username: username,\n        password: password\n      })\n    }).then(function (res) {\n      _this.setToken(res.token); // Setting the token in localStorage\n\n\n      return Promise.resolve(res);\n    });\n  };\n\n  this.loggedIn = function () {\n    // Checks if there is a saved token and it's still valid\n    var token = _this.getToken(); // Getting token from localstorage\n\n\n    return !!token && !_this.isTokenExpired(token); // handwaiving here\n  };\n\n  this.isTokenExpired = function (token) {\n    try {\n      var decoded = decode(token);\n\n      if (decoded.exp < Date.now() / 1000) {\n        // Checking if token is expired.\n        return true;\n      } else return false;\n    } catch (err) {\n      console.log(\"expired check failed! Line 42: AuthService.js\");\n      return false;\n    }\n  };\n\n  this.setToken = function (idToken) {\n    // Saves user token to localStorage\n    localStorage.setItem(\"id_token\", idToken);\n  };\n\n  this.getToken = function () {\n    // Retrieves the user token from localStorage\n    return localStorage.getItem(\"id_token\");\n  };\n\n  this.logout = function () {\n    // Clear user token and profile data from localStorage\n    localStorage.removeItem(\"id_token\");\n  };\n\n  this.getConfirm = function () {\n    // Using jwt-decode npm package to decode the token\n    var answer = decode(_this.getToken());\n    console.log(\"Recieved answer!\");\n    return answer;\n  };\n\n  this.fetch = function (url, options) {\n    // performs api calls sending the required authentication headers\n    var headers = {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\"\n    }; // Setting Authorization header\n    // Authorization: Bearer xxxxxxx.xxxxxxxx.xxxxxx\n\n    if (_this.loggedIn()) {\n      headers[\"Authorization\"] = \"Bearer \" + _this.getToken();\n    }\n\n    return fetch(url, _objectSpread({\n      headers: headers\n    }, options)).then(_this._checkStatus).then(function (response) {\n      return response.json();\n    });\n  };\n\n  this._checkStatus = function (response) {\n    // raises an error in case response status is not a success\n    if (response.status >= 200 && response.status < 300) {\n      // Success status lies between 200 to 300\n      return response;\n    } else {\n      var error = new Error(response.statusText);\n      error.response = response;\n      throw error;\n    }\n  };\n\n  //THIS LINE IS ONLY USED WHEN YOU'RE IN PRODUCTION MODE!\n  this.domain = domain || \"https://blooming-cove-35281.herokuapp.com\"; // API server domain\n};\n\nexport { AuthHelperMethods as default };","map":{"version":3,"sources":["/home/roxiler/Desktop/formik_demo/src/services/AuthService.js"],"names":["decode","AuthHelperMethods","domain","login","username","password","fetch","method","body","JSON","stringify","then","res","setToken","token","Promise","resolve","loggedIn","getToken","isTokenExpired","decoded","exp","Date","now","err","console","log","idToken","localStorage","setItem","getItem","logout","removeItem","getConfirm","answer","url","options","headers","Accept","_checkStatus","response","json","status","error","Error","statusText"],"mappings":"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","sourcesContent":["import decode from \"jwt-decode\";\n\nexport default class AuthHelperMethods {\n  // Initializing important variables\n  constructor(domain) {\n    //THIS LINE IS ONLY USED WHEN YOU'RE IN PRODUCTION MODE!\n    this.domain = domain || \"https://blooming-cove-35281.herokuapp.com\"; // API server domain\n  }\n  login = (username, password) => {\n    // Get a token from api server using the fetch api\n    return this.fetch(`/api/oauth/token`, {\n      method: \"POST\",\n      body: JSON.stringify({\n        username,\n        password\n      })\n    }).then(res => {\n      this.setToken(res.token); // Setting the token in localStorage\n      return Promise.resolve(res);\n    });\n  };\n\n  loggedIn = () => {\n    // Checks if there is a saved token and it's still valid\n    const token = this.getToken(); // Getting token from localstorage\n    return !!token && !this.isTokenExpired(token); // handwaiving here\n  };\n\n  isTokenExpired = token => {\n    try {\n      const decoded = decode(token);\n      if (decoded.exp < Date.now() / 1000) {\n        // Checking if token is expired.\n        return true;\n      } else return false;\n    } catch (err) {\n      console.log(\"expired check failed! Line 42: AuthService.js\");\n      return false;\n    }\n  };\n\n  setToken = idToken => {\n    // Saves user token to localStorage\n    localStorage.setItem(\"id_token\", idToken);\n  };\n\n  getToken = () => {\n    // Retrieves the user token from localStorage\n    return localStorage.getItem(\"id_token\");\n  };\n\n  logout = () => {\n    // Clear user token and profile data from localStorage\n    localStorage.removeItem(\"id_token\");\n  };\n\n  getConfirm = () => {\n    // Using jwt-decode npm package to decode the token\n    let answer = decode(this.getToken());\n    console.log(\"Recieved answer!\");\n    return answer;\n  };\n\n  fetch = (url, options) => {\n    // performs api calls sending the required authentication headers\n    const headers = {\n      Accept: \"application/json\",\n      \"Content-Type\": \"application/json\"\n    };\n    // Setting Authorization header\n    // Authorization: Bearer xxxxxxx.xxxxxxxx.xxxxxx\n    if (this.loggedIn()) {\n      headers[\"Authorization\"] = \"Bearer \" + this.getToken();\n    }\n\n    return fetch(url, {\n      headers,\n      ...options\n    })\n      .then(this._checkStatus)\n      .then(response => response.json());\n  };\n\n  _checkStatus = response => {\n    // raises an error in case response status is not a success\n    if (response.status >= 200 && response.status < 300) {\n      // Success status lies between 200 to 300\n      return response;\n    } else {\n      var error = new Error(response.statusText);\n      error.response = response;\n      throw error;\n    }\n  };\n}\n"]},"metadata":{},"sourceType":"module"}